{-# OPTIONS_GHC -fno-warn-wrong-do-bind #-}

import Development.Shake
import Control.Applicative ((<$>))

opts = shakeOptions { shakeFiles    = ".shake/"
                    , shakeProgress = progressSimple }

main :: IO ()
main = shakeArgs opts $ do
  want ["dist/build/blog/blog"]

  "dist/build/blog/blog" *> \_ -> do
    need <$> srcFiles
    cmd "cabal" ["install"]

srcFiles :: Action [FilePath]
srcFiles = getDirectoryFiles "./" ["src/*.hs","src/blog/*.hs"]
